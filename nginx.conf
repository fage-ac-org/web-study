# 自定义 nginx 配置，解决前端路由刷新 404 问题
server {
  listen 80;
  server_name _;

  # 指向 Vite 构建后的静态资源目录
  root /usr/share/nginx/html;
  index index.html;

  location / {
    # 若找不到具体文件，则回退到单页应用入口
    try_files $uri $uri/ /index.html;
  }

  location = /index.html {
    # 禁止缓存入口文件，确保每次访问都能加载最新资源引用
    add_header Cache-Control "no-cache, no-store, must-revalidate" always;
    add_header Pragma "no-cache" always;
    add_header Expires "0" always;
  }

  location /assets/ {
    # 前端静态资源开启长缓存，提高加载效率
    access_log off;
    expires 1y;
    add_header Cache-Control "public";
  }
}
